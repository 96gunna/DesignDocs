# Graphic Color Choices

The current color system in OED has two issues. First, the actual colors do not always show up well and are not always easy to tell apart (see issue #495 and linked PR #443). I have not carefully checked the new colors so we can consider changing them if appropriate. Also, the work is off an old branch so it may be better to begin work from current development and add this in (with credit to Mark). Second, as noted in PR #443, the color choice system can be improved. The goals of a new system are:

1. Separate the colors of meters and groups so it is easier to visually differentiate them.
2. Try not to reuse any color until all colors have been used up.

Here are ideas on how to address these goals. For #1 we put colors in families. For example, the blues, purples, etc. could be in one color palette and the reds, oranges, etc. could be in the second color palette. The meters would try to use one palette and the groups would use the other color palette. This can probably be done by changing specific digits in the colors in a systematic way which may mean changing the exact colors used. For goal #2, we use the separate color palettes to select meters and groups. There are two ideas. One is to keep all the colors in one array and begin with meters in color one palette and groups in the other but allow them to cross into the other color palette if you have too many of either one. The reason to consider this is that the number of meters vs. groups will vary by installation and is unknown in advance. The second idea is to use two separate arrays and not allow the use of colors between the two palettes. The advantage is that the meter and group colors never overlap but they are more likely to overlap within a color group since there are fewer in each array vs a single combined array. In the first idea, begin by using the first half of the array for meters and the second half for groups. Practically, you start at index 0 for meters and the last index for groups and move toward the center of the array for both. It is possible to cross the center for either meters or groups when you have too many. You can pick the index based on the database ID for each entry (there is a function to return this value). The meters and groups have separate ID numbers where they start at 1 for each. While you can get breaks in the number sequence due to removal of meters/groups, this is not common so they normally go sequentially. Thus, a meter would use an index (meterID % array size) and groups would do something similar but you need to start at the last index and count down with modulo of array size. In the second idea, you have two separate arrays where you just modulo the respective array size of the ID of either meter or group. Note that groups and meters are graphed in different loops so you can tell which is which but the new color function needs a parameter to know whether meter or group color is needed. There is also code for color choices for each graphic type: line, bar, compare & map if I recall correctly. Iâ€™m not sure which idea is better but am leaning toward making sure each line has a unique color whenever possible. This would prefer the first idea so lets do it first (even though it is a little more complex).

Another question is how many colors to have in the array. More colors mean that more meters and/or groups will have unique colors. However, the colors will be harder to tell apart as you have more of them. I think some testing is needed to see what works so automatically generating the colors based on changing digits in the color array might be best. This does not have to be in the final code but something used to general the colors (and could be left in commented out code.)

## Implementation

This work was completed with PR #538. In the end, one array was used where it starts at different ends of the array for groups and meters. The array size was chosen to be prime to avoid cycles (per hashing techniques).
